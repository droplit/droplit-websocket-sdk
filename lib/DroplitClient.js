"use strict";
const events_1 = require('events');
const Transport_1 = require('./Transport');
const Transport_2 = require('./Transport');
class DroplitClient extends events_1.EventEmitter {
    constructor(host) {
        super();
        this.transport = undefined;
        this.transport = new Transport_1.Transport(host);
        this.init();
    }
    init() {
        this.transport.on('connected', () => {
            this.emit('connected');
        });
        this.transport.on('authenticateRequest', () => {
            this.emit('authenticateRequest');
        });
        this.transport.on('authenticated', () => {
            this.emit('authenticated');
        });
        this.transport.on('event', (data) => {
            this.emit('event', data);
        });
        this.transport.on('closed', () => {
            this.emit('closed');
        });
        this.transport.on('socketError', (error) => {
            this.emit('socketError', error);
        });
        this.transport.on('socketInfo', (info) => {
            this.emit('socketInfo', info);
        });
    }
    authenticate(authorizationToken) {
        this.transport.sendMessage(Transport_2.ClientMessageType.authenticate, authorizationToken);
    }
    subscribe(resourceId) {
        this.transport.sendMessage(Transport_2.ClientMessageType.subscribe, resourceId);
    }
    unsubscribe(resourceId) {
        this.transport.sendMessage(Transport_2.ClientMessageType.unsubscribe, resourceId);
    }
    reopen() {
        this.transport.startConnection();
    }
    close() {
        this.transport.closeConnection();
    }
}
exports.DroplitClient = DroplitClient;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkRyb3BsaXRDbGllbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLHlCQUE2QixRQUFRLENBQUMsQ0FBQTtBQUN0Qyw0QkFBMEIsYUFBYSxDQUFDLENBQUE7QUFDeEMsNEJBQWtDLGFBQWEsQ0FBQyxDQUFBO0FBRWhELDRCQUFtQyxxQkFBWTtJQUczQyxZQUFZLElBQVk7UUFDcEIsT0FBTyxDQUFDO1FBSEosY0FBUyxHQUFjLFNBQVMsQ0FBQztRQUlyQyxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUkscUJBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNyQyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDaEIsQ0FBQztJQUNPLElBQUk7UUFDUixJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUUsQ0FBQyxXQUFXLEVBQUU7WUFDM0IsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUMzQixDQUFDLENBQUMsQ0FBQztRQUNILElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDLHFCQUFxQixFQUFFO1lBQ3JDLElBQUksQ0FBQyxJQUFJLENBQUMscUJBQXFCLENBQUMsQ0FBQztRQUNyQyxDQUFDLENBQUMsQ0FBQztRQUNILElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDLGVBQWUsRUFBRTtZQUMvQixJQUFJLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDO1FBQy9CLENBQUMsQ0FBQyxDQUFDO1FBQ0gsSUFBSSxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLENBQUMsSUFBUztZQUNqQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQztRQUM3QixDQUFDLENBQUMsQ0FBQztRQUNILElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDLFFBQVEsRUFBRTtZQUN4QixJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ3hCLENBQUMsQ0FBQyxDQUFDO1FBQ0gsSUFBSSxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUMsYUFBYSxFQUFFLENBQUMsS0FBVTtZQUN4QyxJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUNwQyxDQUFDLENBQUMsQ0FBQztRQUNILElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDLFlBQVksRUFBRSxDQUFDLElBQVM7WUFDdEMsSUFBSSxDQUFDLElBQUksQ0FBQyxZQUFZLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDbEMsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDO0lBRU0sWUFBWSxDQUFDLGtCQUEwQjtRQUMxQyxJQUFJLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyw2QkFBaUIsQ0FBQyxZQUFZLEVBQUUsa0JBQWtCLENBQUMsQ0FBQztJQUNuRixDQUFDO0lBRU0sU0FBUyxDQUFDLFVBQWtCO1FBQy9CLElBQUksQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLDZCQUFpQixDQUFDLFNBQVMsRUFBRSxVQUFVLENBQUMsQ0FBQztJQUN4RSxDQUFDO0lBRU0sV0FBVyxDQUFDLFVBQWtCO1FBQ2pDLElBQUksQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLDZCQUFpQixDQUFDLFdBQVcsRUFBRSxVQUFVLENBQUMsQ0FBQztJQUMxRSxDQUFDO0lBRU0sTUFBTTtRQUNULElBQUksQ0FBQyxTQUFTLENBQUMsZUFBZSxFQUFFLENBQUM7SUFDckMsQ0FBQztJQUVNLEtBQUs7UUFDUixJQUFJLENBQUMsU0FBUyxDQUFDLGVBQWUsRUFBRSxDQUFDO0lBQ3JDLENBQUM7QUFDTCxDQUFDO0FBbkRZLHFCQUFhLGdCQW1EekIsQ0FBQSIsImZpbGUiOiJEcm9wbGl0Q2xpZW50LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRXZlbnRFbWl0dGVyIH0gZnJvbSAnZXZlbnRzJztcbmltcG9ydCB7IFRyYW5zcG9ydCB9IGZyb20gJy4vVHJhbnNwb3J0JztcbmltcG9ydCB7IENsaWVudE1lc3NhZ2VUeXBlIH0gZnJvbSAnLi9UcmFuc3BvcnQnO1xuXG5leHBvcnQgY2xhc3MgRHJvcGxpdENsaWVudCBleHRlbmRzIEV2ZW50RW1pdHRlciB7XG4gICAgcHJpdmF0ZSB0cmFuc3BvcnQ6IFRyYW5zcG9ydCA9IHVuZGVmaW5lZDtcblxuICAgIGNvbnN0cnVjdG9yKGhvc3Q6IHN0cmluZykge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnRyYW5zcG9ydCA9IG5ldyBUcmFuc3BvcnQoaG9zdCk7XG4gICAgICAgIHRoaXMuaW5pdCgpO1xuICAgIH1cbiAgICBwcml2YXRlIGluaXQoKSB7XG4gICAgICAgIHRoaXMudHJhbnNwb3J0Lm9uKCdjb25uZWN0ZWQnLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmVtaXQoJ2Nvbm5lY3RlZCcpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy50cmFuc3BvcnQub24oJ2F1dGhlbnRpY2F0ZVJlcXVlc3QnLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmVtaXQoJ2F1dGhlbnRpY2F0ZVJlcXVlc3QnKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMudHJhbnNwb3J0Lm9uKCdhdXRoZW50aWNhdGVkJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5lbWl0KCdhdXRoZW50aWNhdGVkJyk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnRyYW5zcG9ydC5vbignZXZlbnQnLCAoZGF0YTogYW55KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmVtaXQoJ2V2ZW50JywgZGF0YSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnRyYW5zcG9ydC5vbignY2xvc2VkJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5lbWl0KCdjbG9zZWQnKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMudHJhbnNwb3J0Lm9uKCdzb2NrZXRFcnJvcicsIChlcnJvcjogYW55KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmVtaXQoJ3NvY2tldEVycm9yJywgZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy50cmFuc3BvcnQub24oJ3NvY2tldEluZm8nLCAoaW5mbzogYW55KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmVtaXQoJ3NvY2tldEluZm8nLCBpbmZvKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHVibGljIGF1dGhlbnRpY2F0ZShhdXRob3JpemF0aW9uVG9rZW46IHN0cmluZykge1xuICAgICAgICB0aGlzLnRyYW5zcG9ydC5zZW5kTWVzc2FnZShDbGllbnRNZXNzYWdlVHlwZS5hdXRoZW50aWNhdGUsIGF1dGhvcml6YXRpb25Ub2tlbik7XG4gICAgfVxuXG4gICAgcHVibGljIHN1YnNjcmliZShyZXNvdXJjZUlkOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy50cmFuc3BvcnQuc2VuZE1lc3NhZ2UoQ2xpZW50TWVzc2FnZVR5cGUuc3Vic2NyaWJlLCByZXNvdXJjZUlkKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgdW5zdWJzY3JpYmUocmVzb3VyY2VJZDogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMudHJhbnNwb3J0LnNlbmRNZXNzYWdlKENsaWVudE1lc3NhZ2VUeXBlLnVuc3Vic2NyaWJlLCByZXNvdXJjZUlkKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgcmVvcGVuKCkge1xuICAgICAgICB0aGlzLnRyYW5zcG9ydC5zdGFydENvbm5lY3Rpb24oKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMudHJhbnNwb3J0LmNsb3NlQ29ubmVjdGlvbigpO1xuICAgIH1cbn0iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
